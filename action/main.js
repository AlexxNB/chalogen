var le=Object.create,S=Object.defineProperty,ce=Object.getPrototypeOf,de=Object.prototype.hasOwnProperty,fe=Object.getOwnPropertyNames,pe=Object.getOwnPropertyDescriptor;var he=e=>S(e,"__esModule",{value:!0});var b=(e,t)=>()=>(t||(t={exports:{}},e(t.exports,t)),t.exports);var ge=(e,t,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of fe(t))!de.call(e,r)&&r!=="default"&&S(e,r,{get:()=>t[r],enumerable:!(n=pe(t,r))||n.enumerable});return e},O=e=>ge(he(S(e!=null?le(ce(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var w=b(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});function me(e){return e==null?"":typeof e=="string"||e instanceof String?e:JSON.stringify(e)}j.toCommandValue=me});var U=b(y=>{"use strict";var ye=y&&y.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(y,"__esModule",{value:!0});var _e=ye(require("os")),T=w();function I(e,t,n){let r=new B(e,t,n);process.stdout.write(r.toString()+_e.EOL)}y.issueCommand=I;function be(e,t=""){I(e,{},t)}y.issue=be;var q="::",B=class{constructor(t,n,r){t||(t="missing.command"),this.command=t,this.properties=n,this.message=r}toString(){let t=q+this.command;if(this.properties&&Object.keys(this.properties).length>0){t+=" ";let n=!0;for(let r in this.properties)if(this.properties.hasOwnProperty(r)){let i=this.properties[r];i&&(n?n=!1:t+=",",t+=`${r}=${we(i)}`)}}return t+=`${q}${Fe(this.message)}`,t}};function Fe(e){return T.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function we(e){return T.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}});var G=b(F=>{"use strict";var M=F&&F.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(F,"__esModule",{value:!0});var x=M(require("fs")),$e=M(require("os")),ve=w();function Ce(e,t){let n=process.env[`GITHUB_${e}`];if(!n)throw new Error(`Unable to find environment variable for file command ${e}`);if(!x.existsSync(n))throw new Error(`Missing file at path: ${n}`);x.appendFileSync(n,`${ve.toCommandValue(t)}${$e.EOL}`,{encoding:"utf8"})}F.issueCommand=Ce});var J=b(s=>{"use strict";var Se=s&&s.__awaiter||function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(u){u(o)})}return new(n||(n=Promise))(function(o,u){function a(l){try{g(r.next(l))}catch(m){u(m)}}function p(l){try{g(r.throw(l))}catch(m){u(m)}}function g(l){l.done?o(l.value):i(l.value).then(a,p)}g((r=r.apply(e,t||[])).next())})},N=s&&s.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(s,"__esModule",{value:!0});var f=U(),H=G(),Oe=w(),A=N(require("os")),je=N(require("path")),L;(function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure"})(L=s.ExitCode||(s.ExitCode={}));function Ae(e,t){let n=Oe.toCommandValue(t);if(process.env[e]=n,process.env.GITHUB_ENV||""){let i="_GitHubActionsFileCommandDelimeter_",o=`${e}<<${i}${A.EOL}${n}${A.EOL}${i}`;H.issueCommand("ENV",o)}else f.issueCommand("set-env",{name:e},n)}s.exportVariable=Ae;function Ee(e){f.issueCommand("add-mask",{},e)}s.setSecret=Ee;function ke(e){process.env.GITHUB_PATH||""?H.issueCommand("PATH",e):f.issueCommand("add-path",{},e),process.env.PATH=`${e}${je.delimiter}${process.env.PATH}`}s.addPath=ke;function Ve(e,t){let n=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!n)throw new Error(`Input required and not supplied: ${e}`);return n.trim()}s.getInput=Ve;function De(e,t){f.issueCommand("set-output",{name:e},t)}s.setOutput=De;function Pe(e){f.issue("echo",e?"on":"off")}s.setCommandEcho=Pe;function Te(e){process.exitCode=L.Failure,R(e)}s.setFailed=Te;function Be(){return process.env.RUNNER_DEBUG==="1"}s.isDebug=Be;function Ie(e){f.issueCommand("debug",{},e)}s.debug=Ie;function R(e){f.issue("error",e instanceof Error?e.toString():e)}s.error=R;function qe(e){f.issue("warning",e instanceof Error?e.toString():e)}s.warning=qe;function Ue(e){process.stdout.write(e+A.EOL)}s.info=Ue;function z(e){f.issue("group",e)}s.startGroup=z;function Y(){f.issue("endgroup")}s.endGroup=Y;function Me(e,t){return Se(this,void 0,void 0,function*(){z(e);let n;try{n=yield t()}finally{Y()}return n})}s.group=Me;function xe(e,t){f.issueCommand("save-state",{name:e},t)}s.saveState=xe;function Ge(e){return process.env[`STATE_${e}`]||""}s.getState=Ge});var se=b(E=>{var Ne=Object.create,$=Object.defineProperty,He=Object.getPrototypeOf,Le=Object.prototype.hasOwnProperty,Re=Object.getOwnPropertyNames,ze=Object.getOwnPropertyDescriptor,K=e=>$(e,"__esModule",{value:!0}),Ye=(e,t)=>{for(var n in t)$(e,n,{get:t[n],enumerable:!0})},Je=(e,t,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Re(t))!Le.call(e,r)&&r!=="default"&&$(e,r,{get:()=>t[r],enumerable:!(n=ze(t,r))||n.enumerable});return e},k=e=>Je(K($(e!=null?Ne(He(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);K(E);Ye(E,{addAction:()=>Ke,default_options:()=>Q,render:()=>Qe});var We=k(require("child_process"));function v(e){return e.replace(/\n/g," ").replace(/\s+/g," ").replace(/^\s|\s$/g,"")}function W(e,t){t=t||"%Y-%M-%D";let n=a=>a<10?"0"+a:a,r=new Date(e*1e3),i=r.getFullYear(),o=r.getMonth()+1,u=r.getDate();return t.replace(/%Y/g,i).replace(/%M/g,n(o)).replace(/%D/g,n(u))}var X={feat:"Features",fix:"Bug Fixes",docs:"Documentation",style:"Styles",refactor:"Code Refactoring",perf:"Performance Improvements",test:"Tests",build:"Builds",ci:"Continuous Integrations",chore:"Chores",revert:"Reverts"};function Z(e){return e=="other"?"Other":X[e]||"Unknown type"}function Xe(e){return e.reduce((t,n)=>{let r=n.subject.match(/^(?:(\w+?)(?:\((.*?)\))?:\s*)?(.+)$/);if(!r)return t;let i=r[1]&&X[r[1]]&&r[1]||"other";return i=="docs"&&r[2]=="Changelog"||(t[i]||(t[i]=[]),t[i].push({...n,subject:r[3],namespace:r[2]||null})),t},{})}function tt(e){let t=Ze(),n=et(),r={list:{},addVersion(i,o){this.list[i]={date:o||null,commits:[]}},addCommit(i){let o=Object.entries(this.list).sort((u,a)=>u[1].date===null?-1:a[1].date===null?1:a[1].date-u[1].date).reduce((u,[a,p])=>(p.date||Infinity)>=i.date?p:u,null);o&&o.commits.push(i)}};if(r.addVersion("unreleased",null),t.forEach((i,o)=>{let u=i.subject.match(/^(?:(?:\->\s+)?(?:v|v\.|v\.\s+))?(\d\.\d\.\d.*)/);u&&(r.addVersion(u[1],i.date),delete t[o])}),n.forEach(i=>{r.addVersion(i.tag,i.date)}),t.forEach(i=>r.addCommit(i)),e)for(let i in r.list)r.list[i].commits=Xe(r.list[i].commits);return Object.keys(r.list.unreleased.commits).length==0&&delete r.list.unreleased,r.list}function Ze(){let e=[],t=V("log","--pretty=format:begin:%H:*:%at:*:%an:*:%B:end","--date=raw"),n=/^begin:([\s\S]+?):end$/gm,r;for(;r=n.exec(t);){let i=r[1].split(":*:"),o=i[3].split(`

`);e.push({date:Number(i[1]),hash:i[0],author:i[2],subject:v(o[0]),body:o[1]&&v(o[1])||null,footer:o[2]&&v(o[2])||null,issues:rt(i[3])})}return e}function et(){let e=[],t=V("log","--tags","--simplify-by-decoration",'--pretty="format:begin:%at:*:%D:end"'),n=/^begin:([\s\S]+?):end$/gm,r;for(;r=n.exec(t);){let i=r[1].split(":*:"),o=i[1].match(/tag:\s+(?:v|v\.|v\.\s+)?(\d.+?),/);o&&e.push({date:Number(i[0]),tag:v(o[1])})}return e}function nt(){let e=V("config","--get","remote.origin.url"),t=e.match(/git@(.+?):(.+?)\/(.+?).git/);return t||(t=e.match(/https?:\/\/(.+?)\/(.+?)\/(.+)/)),t?{type:t[1].replace(/\..+$/,""),url:"https://"+t[1],owner:t[2],project:t[3]}:null}function ee(e,t){return`${e.url}/${e.owner}/${e.project}/issues/${t}`}function te(e,t){return`${e.url}/${e.owner}/${e.project}/${e.type=="bitbucket"?"commits":"commit"}/${t}`}function V(){return(0,We.execSync)("git "+Array.from(arguments).join(" ")).toString("utf-8")}function rt(e){let t=/(?:issues\/(\d+)| #(\d+)|^#(\d+))/g,n=[],r;for(;r=t.exec(e);)n.push(r[1]||r[2]||r[3]);return[...new Set(n)]}var h=(e,t,n)=>`[${t}m${e}[${n}m`,c={blue:e=>h(e,34,39),red:e=>h(e,31,39),green:e=>h(e,32,39),yellow:e=>h(e,33,39),magenta:e=>h(e,35,39),cyan:e=>h(e,36,39),gray:e=>h(e,90,39),bold:e=>h(e,1,22),italic:e=>h(e,3,23),link:(e,t)=>`]8;;${t}\x07${e}]8;;\x07`},it="\u{1F3A8}",ot="\u26A1\uFE0F",st="\u{1F525}",ut="\u{1F41B}",at="\u{1F691}",lt="\u2728",ct="\u{1F4DD}",dt="\u{1F680}",ft="\u{1F484}",pt="\u{1F389}",ht="\u2705",gt="\u{1F512}",mt="\u{1F516}",yt="\u{1F6A8}",_t="\u{1F6A7}",bt="\u{1F49A}",Ft="\u2B07\uFE0F",wt="\u2B06\uFE0F",$t="\u{1F4CC}",vt="\u{1F477}",Ct="\u{1F4C8}",St="\u267B\uFE0F",Ot="\u2795",jt="\u2796",At="\u{1F527}",Et="\u{1F528}",kt="\u{1F310}",Vt="\u270F\uFE0F",Dt="\u{1F4A9}",Pt="\u23EA",Tt="\u{1F500}",Bt="\u{1F4E6}",It="\u{1F47D}",qt="\u{1F69A}",Ut="\u{1F4C4}",Mt="\u{1F4A5}",xt="\u{1F371}",Gt="\u267F\uFE0F",Nt="\u{1F4A1}",Ht="\u{1F37B}",Lt="\u{1F4AC}",Rt="\u{1F5C3}",zt="\u{1F50A}",Yt="\u{1F507}",Jt="\u{1F465}",Kt="\u{1F6B8}",Qt="\u{1F3D7}",Wt="\u{1F4F1}",Xt="\u{1F921}",Zt="\u{1F95A}",er="\u{1F648}",tr="\u{1F4F8}",rr="\u2697",nr="\u{1F50D}",ir="\u{1F3F7}\uFE0F",or="\u{1F331}",sr="\u{1F6A9}",ur="\u{1F945}",ar="\u{1F4AB}",lr="\u{1F5D1}",cr="\u{1F6C2}",dr="\u{1FA79}",fr="\u{1F9D0}",pr={":art:":it,":zap:":ot,":fire:":st,":bug:":ut,":ambulance:":at,":sparkles:":lt,":memo:":ct,":rocket:":dt,":lipstick:":ft,":tada:":pt,":white_check_mark:":ht,":lock:":gt,":bookmark:":mt,":rotating_light:":yt,":construction:":_t,":green_heart:":bt,":arrow_down:":Ft,":arrow_up:":wt,":pushpin:":$t,":construction_worker:":vt,":chart_with_upwards_trend:":Ct,":recycle:":St,":heavy_plus_sign:":Ot,":heavy_minus_sign:":jt,":wrench:":At,":hammer:":Et,":globe_with_meridians:":kt,":pencil2:":Vt,":poop:":Dt,":rewind:":Pt,":twisted_rightwards_arrows:":Tt,":package:":Bt,":alien:":It,":truck:":qt,":page_facing_up:":Ut,":boom:":Mt,":bento:":xt,":wheelchair:":Gt,":bulb:":Nt,":beers:":Ht,":speech_balloon:":Lt,":card_file_box:":Rt,":loud_sound:":zt,":mute:":Yt,":busts_in_silhouette:":Jt,":children_crossing:":Kt,":building_construction:":Qt,":iphone:":Wt,":clown_face:":Xt,":egg:":Zt,":see_no_evil:":er,":camera_flash:":tr,":alembic:":rr,":mag:":nr,":label:":ir,":seedling:":or,":triangular_flag_on_post:":sr,":goal_net:":ur,":dizzy:":ar,":wastebasket:":lr,":passport_control:":cr,":adhesive_bandage:":dr,":monocle_face:":fr};function C(e){return e.replace(/:\w+?:/g,t=>pr[t]||"")}function hr(){let e="",t=(r,i)=>i&&r.repeat(i)||"",n=r=>t("    ",r);return{header(r,i,o){e+=`

${n(o)}${t("#",i)} ${r}`},list(r,i){e+=`
${n(i)}${i%2?"*":"-"} ${r}`},line(r,i){e+=`
${n(i)}${r}`},newline(){e+=`
`},paragraph(r,i){this.newline(),this.line(r,i)},hr(){this.line("---")},link(r,i){return`[${r}](${i})`},bold(r){return`**${r}**`},italic(r){return`*${r}*`},code(r){return`\`${r}\``},render(){return e.replace(/^\s+|\s+$/g,"")}}}var _=console.log;function gr(e){if(e.showTitle&&(_(c.bold(e.title)),_()),e.onlyVersion){let t=e.history[e.onlyVersion];e.history={},t&&(e.history[e.onlyVersion]=t)}for(let t in e.history){if(!e.showUnreleased&&t=="unreleased")continue;let n=e.history[t];!e.onlyVersion&&_(`${c.yellow(t)}${n.date?c.gray(" - "+W(n.date,e.dateFormat)):""}`);for(let r of e.showTypes)if(n.commits[r]){_(" ",`${c.bold(c.green(Z(r)))}:`);for(let i of n.commits[r]){let o=i.namespace?c.bold(i.namespace+": "):"",u=C(re(i.subject)),a=i.body&&c.gray(C(re(i.body))),p=i.issues&&i.issues.length&&` (${i.issues.map(l=>c.link("#"+l,ee(e.repo,l))).join(", ")})`,g=c.blue(c.link(i.hash.substring(0,8),te(e.repo,i.hash)));_("  ",c.green("*"),`${o}${u}${p||""} ${g}`),e.showBody&&a&&_("    ",a)}}}}function mr(e){let t=hr();if(e.showTitle&&t.header(e.title,1,0),e.onlyVersion){let n=e.history[e.onlyVersion];e.history={},n&&(e.history[e.onlyVersion]=n)}for(let n in e.history){if(!e.showUnreleased&&n=="unreleased")continue;let r=e.history[n];!e.onlyVersion&&t.header(`${n}${r.date?" - "+W(r.date,e.dateFormat):""}`,2,0);for(let i of e.showTypes)if(r.commits[i]){t.header(Z(i),3,0),t.newline();for(let o of r.commits[i]){let u=o.namespace?t.bold(o.namespace+":")+" ":"",a=C(ne(o.subject,t)),p=o.body&&C(ne(o.body,t)),g=o.issues&&o.issues.length&&` (${o.issues.map(m=>t.link("#"+m,ee(e.repo,m))).join(", ")})`,l=t.link(t.code(o.hash.substring(0,8)),te(e.repo,o.hash));t.list(`${u}${a}${g||""} ${l}`,0),e.showBody&&p&&t.paragraph(t.italic(p),1)}}}return t.render()}function re(e){return e.replace(/https?:\/\/.+?\/(?:issues|pull|merge_requests|pull_requests)\/(\d+)(?:\/\S*)?/gi,(t,n)=>c.link("#"+n,t))}function ne(e,t){return e.replace(/https?:\/\/.+?\/(?:issues|pull|merge_requests|pull_requests)\/(\d+)(?:\/\S*)?/gi,(n,r)=>t.link("#"+r,n))}var D=k(require("fs")),ie=k(require("path")),oe=ie.default.join(".github","workflows");function Ke(e){e=(e||"generate_changelog")+".yml";let t=ie.default.join(oe,e);D.default.existsSync(t)&&(console.log(`Action file with name ${e} already exists`),process.exit(1)),D.default.mkdirSync(oe,{recursive:!0}),D.default.writeFileSync(t,yr())}function yr(){return`name: Generate Changelog

on:
  push:
    branches: [ main, master]

jobs:
  changelog:
    name: Update Changelog
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
        with:
          fetch-depth: 0
      - name: Update Changelog
        uses: AlexxNB/chalogen@master
        with:
          title: My project changelog 
      - name: Commit Changelog to repository
        uses: stefanzweifel/git-auto-commit-action@v4
        with:
          commit_message: 'docs(Changelog): Update Changelog'
          file_pattern: CHANGELOG.md`}var Q={output:"cli",showTypes:["feat","fix","perf","docs","other"],title:"Changelog",dateFormat:"%Y-%M-%D",showUnreleased:!0,showBody:!0,showTitle:!0,onlyVersion:null};function Qe(e){if(e={...Q,...e||{},history:tt(!0),repo:nt()},!e.output||e.output=="markdown")return mr(e);e.output=="cli"&&gr(e)}});var d=O(J()),P=O(se()),ue=O(require("fs"));try{let e={title:d.default.getInput("title"),list:d.default.getInput("list"),date:d.default.getInput("date"),file:d.default.getInput("file"),version:d.default.getInput("version"),unreleased:d.default.getInput("unreleased"),hideUnreleased:d.default.getInput("hide-unreleased"),hideTitle:d.default.getInput("hide-title"),hideBody:d.default.getInput("hide-body"),output:"cli"};console.log("Rendering markdown..."),(0,P.render)(ae(e)),e.output="markdown";let t=(0,P.render)(ae(e));d.default.setOutput("changelog",t),console.log("Saving to "+e.file),ue.default.writeFileSync(e.file,t)}catch(e){d.default.setFailed(e.message)}function ae(e){return{title:e.title,output:e.output||"cli",showTypes:e.list.split(","),dateFormat:e.date,showUnreleased:e.hideUnreleased=="false",showBody:e.hideTitle=="false",showTitle:e.hideBody=="false",onlyVersion:e.version!="false"&&e.version||e.unreleased!="false"&&"unreleased"}}
